function output = pos_endEffector(parameter_input, data)
% INPUT
% first parameter
% sensor offset의 initial value +A1 B1 C1 D1 A2 C2 D2 A3
% C3 D3 A5 C5 D5
% second parameter : simulation data 값 

%pos_frame7 으로 test중 offset 4개 + A1 B1 C1 D1
% output = (56.03*cos(x(1)*pi/180)+24.21-(79.388))^2 + ((-56.03*sin(x(1)*pi/180))-(-9.729))^2;
    
    % initialize output as zero.
%     parameter_input(1:4)= parameter_input(1:4)*pi/180;
    
%     off_TH1 = 10; off_TH1 = off_TH1*pi/180;
%     off_TH2 = 10; off_TH2 = off_TH2*pi/180;
%     off_TH3 = 10; off_TH3 = off_TH3*pi/180;
%     off_TH4 = 10; off_TH4 = off_TH4*pi/180;
   
off_TH1 = parameter_input(1);off_TH2 = parameter_input(2);off_TH3 = parameter_input(3); off_TH4 = parameter_input(4);
A1      = parameter_input(5);B1      = parameter_input(6);C1      = parameter_input(7); D1      = parameter_input(8);
A2      = parameter_input(9);                             C2      = parameter_input(10);D2      = parameter_input(11);
A3      = parameter_input(12);                            C3      = parameter_input(13);D3      = parameter_input(14);

A5 = parameter_input(15);                                 C5 = parameter_input(16);    D5 = parameter_input(17);
A6 = parameter_input(18);                                 C6 = parameter_input(19);    D6 = parameter_input(20);

% A1      = parameter_input(1);B1      = parameter_input(2);C1      = parameter_input(3); D1      = parameter_input(4);
% A2      = parameter_input(5);                             C2      = parameter_input(6);D2      = parameter_input(7);
% A3      = parameter_input(8);                            C3      = parameter_input(9);D3      = parameter_input(10);
% 
% A5 = parameter_input(11);                                 C5 = parameter_input(12);    D5 = parameter_input(13);
% A6 = parameter_input(14);                                 C6 = parameter_input(15);    D6 = parameter_input(16);



pos_reference = data(:, 12:14);
        
    for i=1:size(data, 1)
        
        B2 = data(i,1);B3 = data(i,2);B5 = data(i,3);B6 = data(i,4);
      
        diff_x=C1*cos(B1) - (647*sin(D3)*(sin(B2 + off_TH1)*cos(B1)*sin(D2 + pi/2) + sin(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)))/50 - 37*sin(D6)*(cos(D5)*(cos(D3)*(sin(B2 + off_TH1)*cos(B1)*sin(D2 + pi/2) + sin(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*sin(D3)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) + sin(B3 + off_TH2)*sin(D3)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2))) + cos(B5 + off_TH3)*sin(D5)*(sin(B3 + off_TH2)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(B3 + off_TH2)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2))) + sin(B5 + off_TH3)*sin(D5)*(cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - sin(D3)*(sin(B2 + off_TH1)*cos(B1)*sin(D2 + pi/2) + sin(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)))) + A5*(cos(D3)*(sin(B2 + off_TH1)*cos(B1)*sin(D2 + pi/2) + sin(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*sin(D3)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) + sin(B3 + off_TH2)*sin(D3)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2))) + A3*(sin(B2 + off_TH1)*cos(B1)*sin(D2 + pi/2) + sin(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + A6*(cos(D5)*(cos(D3)*(sin(B2 + off_TH1)*cos(B1)*sin(D2 + pi/2) + sin(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*sin(D3)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) + sin(B3 + off_TH2)*sin(D3)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2))) + cos(B5 + off_TH3)*sin(D5)*(sin(B3 + off_TH2)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(B3 + off_TH2)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2))) + sin(B5 + off_TH3)*sin(D5)*(cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - sin(D3)*(sin(B2 + off_TH1)*cos(B1)*sin(D2 + pi/2) + sin(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)))) + cos(B2 + off_TH1)*cos(B1)*(C2 + 2421/100) + A2*sin(B1)*sin(D1 - pi/2) - cos(B6 + off_TH4)*(C6 + 69/4)*(sin(B5 + off_TH3)*(sin(B3 + off_TH2)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(B3 + off_TH2)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2))) - cos(B5 + off_TH3)*(cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - sin(D3)*(sin(B2 + off_TH1)*cos(B1)*sin(D2 + pi/2) + sin(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)))) - 37*sin(B6 + off_TH4)*cos(D6)*(sin(B5 + off_TH3)*(sin(B3 + off_TH2)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(B3 + off_TH2)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2))) - cos(B5 + off_TH3)*(cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - sin(D3)*(sin(B2 + off_TH1)*cos(B1)*sin(D2 + pi/2) + sin(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)))) + cos(B5 + off_TH3)*(C5 + 115/2)*(cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - sin(D3)*(sin(B2 + off_TH1)*cos(B1)*sin(D2 + pi/2) + sin(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2))) + cos(B3 + off_TH2)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2))*(C3 + 5603/100) + (647*cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)))/50 + (647*sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)))/50 - sin(B3 + off_TH2)*(C3 + 5603/100)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) + 37*cos(B6 + off_TH4)*cos(D6)*(sin(B5 + off_TH3)*cos(D5)*(cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - sin(D3)*(sin(B2 + off_TH1)*cos(B1)*sin(D2 + pi/2) + sin(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2))) - sin(D5)*(cos(D3)*(sin(B2 + off_TH1)*cos(B1)*sin(D2 + pi/2) + sin(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*sin(D3)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) + sin(B3 + off_TH2)*sin(D3)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2))) + cos(B5 + off_TH3)*cos(D5)*(sin(B3 + off_TH2)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(B3 + off_TH2)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)))) - sin(B6 + off_TH4)*(C6 + 69/4)*(sin(B5 + off_TH3)*cos(D5)*(cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - sin(D3)*(sin(B2 + off_TH1)*cos(B1)*sin(D2 + pi/2) + sin(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2))) - sin(D5)*(cos(D3)*(sin(B2 + off_TH1)*cos(B1)*sin(D2 + pi/2) + sin(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*sin(D3)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) + sin(B3 + off_TH2)*sin(D3)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2))) + cos(B5 + off_TH3)*cos(D5)*(sin(B3 + off_TH2)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(B3 + off_TH2)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)))) - sin(B5 + off_TH3)*(sin(B3 + off_TH2)*(sin(B2 + off_TH1)*cos(B1)*cos(D2 + pi/2) - sin(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(B3 + off_TH2)*(cos(B2 + off_TH1)*cos(B1) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)))*(C5 + 115/2) - sin(B2 + off_TH1)*sin(B1)*cos(D1 - pi/2)*(C2 + 2421/100);
        diff_y=(647*sin(D3)*(cos(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) - sin(B2 + off_TH1)*sin(B1)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)))/50 - 37*sin(D6)*(cos(D5)*(cos(B3 + off_TH2)*sin(D3)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(D3)*(cos(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) - sin(B2 + off_TH1)*sin(B1)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + sin(B3 + off_TH2)*sin(D3)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2))) + sin(B5 + off_TH3)*sin(D5)*(sin(D3)*(cos(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) - sin(B2 + off_TH1)*sin(B1)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) + sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2))) + cos(B5 + off_TH3)*sin(D5)*(sin(B3 + off_TH2)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(B3 + off_TH2)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)))) + C1*sin(B1) + A6*(cos(D5)*(cos(B3 + off_TH2)*sin(D3)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(D3)*(cos(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) - sin(B2 + off_TH1)*sin(B1)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + sin(B3 + off_TH2)*sin(D3)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2))) + sin(B5 + off_TH3)*sin(D5)*(sin(D3)*(cos(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) - sin(B2 + off_TH1)*sin(B1)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) + sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2))) + cos(B5 + off_TH3)*sin(D5)*(sin(B3 + off_TH2)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(B3 + off_TH2)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)))) + A5*(cos(B3 + off_TH2)*sin(D3)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(D3)*(cos(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) - sin(B2 + off_TH1)*sin(B1)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + sin(B3 + off_TH2)*sin(D3)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2))) - A3*(cos(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) - sin(B2 + off_TH1)*sin(B1)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) - 37*sin(B6 + off_TH4)*cos(D6)*(sin(B5 + off_TH3)*(sin(B3 + off_TH2)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(B3 + off_TH2)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2))) - cos(B5 + off_TH3)*(sin(D3)*(cos(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) - sin(B2 + off_TH1)*sin(B1)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) + sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)))) - A2*cos(B1)*sin(D1 - pi/2) + cos(B2 + off_TH1)*sin(B1)*(C2 + 2421/100) + 37*cos(B6 + off_TH4)*cos(D6)*(sin(B5 + off_TH3)*cos(D5)*(sin(D3)*(cos(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) - sin(B2 + off_TH1)*sin(B1)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) + sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2))) - sin(D5)*(cos(B3 + off_TH2)*sin(D3)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(D3)*(cos(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) - sin(B2 + off_TH1)*sin(B1)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + sin(B3 + off_TH2)*sin(D3)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2))) + cos(B5 + off_TH3)*cos(D5)*(sin(B3 + off_TH2)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(B3 + off_TH2)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)))) + cos(B5 + off_TH3)*(C5 + 115/2)*(sin(D3)*(cos(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) - sin(B2 + off_TH1)*sin(B1)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) + sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2))) - sin(B6 + off_TH4)*(C6 + 69/4)*(sin(B5 + off_TH3)*cos(D5)*(sin(D3)*(cos(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) - sin(B2 + off_TH1)*sin(B1)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) + sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2))) - sin(D5)*(cos(B3 + off_TH2)*sin(D3)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(D3)*(cos(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) - sin(B2 + off_TH1)*sin(B1)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + sin(B3 + off_TH2)*sin(D3)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2))) + cos(B5 + off_TH3)*cos(D5)*(sin(B3 + off_TH2)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(B3 + off_TH2)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)))) + cos(B3 + off_TH2)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2))*(C3 + 5603/100) + (647*cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)))/50 - sin(B3 + off_TH2)*(C3 + 5603/100)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) + (647*sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)))/50 - sin(B5 + off_TH3)*(sin(B3 + off_TH2)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(B3 + off_TH2)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)))*(C5 + 115/2) - cos(B6 + off_TH4)*(sin(B5 + off_TH3)*(sin(B3 + off_TH2)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) - cos(B3 + off_TH2)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2))) - cos(B5 + off_TH3)*(sin(D3)*(cos(B1)*cos(D2 + pi/2)*sin(D1 - pi/2) - sin(B2 + off_TH1)*sin(B1)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*cos(D3)*(sin(B2 + off_TH1)*sin(B1)*cos(D2 + pi/2) + cos(B1)*sin(D1 - pi/2)*sin(D2 + pi/2) - cos(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*cos(D2 + pi/2)) + sin(B3 + off_TH2)*cos(D3)*(cos(B2 + off_TH1)*sin(B1) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2))))*(C6 + 69/4) + sin(B2 + off_TH1)*cos(B1)*cos(D1 - pi/2)*(C2 + 2421/100);
        diff_z=A1 + A3*(cos(D1 - pi/2)*cos(D2 + pi/2) - cos(B2 + off_TH1)*sin(D1 - pi/2)*sin(D2 + pi/2)) + A2*cos(D1 - pi/2) + 37*sin(D6)*(cos(B5 + off_TH3)*sin(D5)*(sin(B3 + off_TH2)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) + cos(B3 + off_TH2)*sin(B2 + off_TH1)*sin(D1 - pi/2)) - cos(D5)*(cos(D3)*(cos(D1 - pi/2)*cos(D2 + pi/2) - cos(B2 + off_TH1)*sin(D1 - pi/2)*sin(D2 + pi/2)) - cos(B3 + off_TH2)*sin(D3)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) + sin(B2 + off_TH1)*sin(B3 + off_TH2)*sin(D3)*sin(D1 - pi/2)) + sin(B5 + off_TH3)*sin(D5)*(sin(D3)*(cos(D1 - pi/2)*cos(D2 + pi/2) - cos(B2 + off_TH1)*sin(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*cos(D3)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) - sin(B2 + off_TH1)*sin(B3 + off_TH2)*cos(D3)*sin(D1 - pi/2))) + A5*(cos(D3)*(cos(D1 - pi/2)*cos(D2 + pi/2) - cos(B2 + off_TH1)*sin(D1 - pi/2)*sin(D2 + pi/2)) - cos(B3 + off_TH2)*sin(D3)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) + sin(B2 + off_TH1)*sin(B3 + off_TH2)*sin(D3)*sin(D1 - pi/2)) - (647*sin(D3)*(cos(D1 - pi/2)*cos(D2 + pi/2) - cos(B2 + off_TH1)*sin(D1 - pi/2)*sin(D2 + pi/2)))/50 - A6*(cos(B5 + off_TH3)*sin(D5)*(sin(B3 + off_TH2)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) + cos(B3 + off_TH2)*sin(B2 + off_TH1)*sin(D1 - pi/2)) - cos(D5)*(cos(D3)*(cos(D1 - pi/2)*cos(D2 + pi/2) - cos(B2 + off_TH1)*sin(D1 - pi/2)*sin(D2 + pi/2)) - cos(B3 + off_TH2)*sin(D3)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) + sin(B2 + off_TH1)*sin(B3 + off_TH2)*sin(D3)*sin(D1 - pi/2)) + sin(B5 + off_TH3)*sin(D5)*(sin(D3)*(cos(D1 - pi/2)*cos(D2 + pi/2) - cos(B2 + off_TH1)*sin(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*cos(D3)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) - sin(B2 + off_TH1)*sin(B3 + off_TH2)*cos(D3)*sin(D1 - pi/2))) - (647*cos(B3 + off_TH2)*cos(D3)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)))/50 + sin(B3 + off_TH2)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2))*(C3 + 5603/100) + sin(B2 + off_TH1)*sin(D1 - pi/2)*(C2 + 2421/100) - cos(B5 + off_TH3)*(C5 + 115/2)*(sin(D3)*(cos(D1 - pi/2)*cos(D2 + pi/2) - cos(B2 + off_TH1)*sin(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*cos(D3)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) - sin(B2 + off_TH1)*sin(B3 + off_TH2)*cos(D3)*sin(D1 - pi/2)) - cos(B6 + off_TH4)*(C6 + 69/4)*(cos(B5 + off_TH3)*(sin(D3)*(cos(D1 - pi/2)*cos(D2 + pi/2) - cos(B2 + off_TH1)*sin(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*cos(D3)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) - sin(B2 + off_TH1)*sin(B3 + off_TH2)*cos(D3)*sin(D1 - pi/2)) - sin(B5 + off_TH3)*(sin(B3 + off_TH2)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) + cos(B3 + off_TH2)*sin(B2 + off_TH1)*sin(D1 - pi/2))) - 37*sin(B6 + off_TH4)*cos(D6)*(cos(B5 + off_TH3)*(sin(D3)*(cos(D1 - pi/2)*cos(D2 + pi/2) - cos(B2 + off_TH1)*sin(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*cos(D3)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) - sin(B2 + off_TH1)*sin(B3 + off_TH2)*cos(D3)*sin(D1 - pi/2)) - sin(B5 + off_TH3)*(sin(B3 + off_TH2)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) + cos(B3 + off_TH2)*sin(B2 + off_TH1)*sin(D1 - pi/2))) + sin(B5 + off_TH3)*(C5 + 115/2)*(sin(B3 + off_TH2)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) + cos(B3 + off_TH2)*sin(B2 + off_TH1)*sin(D1 - pi/2)) - 37*cos(B6 + off_TH4)*cos(D6)*(sin(D5)*(cos(D3)*(cos(D1 - pi/2)*cos(D2 + pi/2) - cos(B2 + off_TH1)*sin(D1 - pi/2)*sin(D2 + pi/2)) - cos(B3 + off_TH2)*sin(D3)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) + sin(B2 + off_TH1)*sin(B3 + off_TH2)*sin(D3)*sin(D1 - pi/2)) + cos(B5 + off_TH3)*cos(D5)*(sin(B3 + off_TH2)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) + cos(B3 + off_TH2)*sin(B2 + off_TH1)*sin(D1 - pi/2)) + sin(B5 + off_TH3)*cos(D5)*(sin(D3)*(cos(D1 - pi/2)*cos(D2 + pi/2) - cos(B2 + off_TH1)*sin(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*cos(D3)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) - sin(B2 + off_TH1)*sin(B3 + off_TH2)*cos(D3)*sin(D1 - pi/2))) + sin(B6 + off_TH4)*(C6 + 69/4)*(sin(D5)*(cos(D3)*(cos(D1 - pi/2)*cos(D2 + pi/2) - cos(B2 + off_TH1)*sin(D1 - pi/2)*sin(D2 + pi/2)) - cos(B3 + off_TH2)*sin(D3)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) + sin(B2 + off_TH1)*sin(B3 + off_TH2)*sin(D3)*sin(D1 - pi/2)) + cos(B5 + off_TH3)*cos(D5)*(sin(B3 + off_TH2)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) + cos(B3 + off_TH2)*sin(B2 + off_TH1)*sin(D1 - pi/2)) + sin(B5 + off_TH3)*cos(D5)*(sin(D3)*(cos(D1 - pi/2)*cos(D2 + pi/2) - cos(B2 + off_TH1)*sin(D1 - pi/2)*sin(D2 + pi/2)) + cos(B3 + off_TH2)*cos(D3)*(cos(D1 - pi/2)*sin(D2 + pi/2) + cos(B2 + off_TH1)*cos(D2 + pi/2)*sin(D1 - pi/2)) - sin(B2 + off_TH1)*sin(B3 + off_TH2)*cos(D3)*sin(D1 - pi/2))) + cos(B3 + off_TH2)*sin(B2 + off_TH1)*sin(D1 - pi/2)*(C3 + 5603/100) + (647*sin(B2 + off_TH1)*sin(B3 + off_TH2)*cos(D3)*sin(D1 - pi/2))/50;
        
        
        ref_x = pos_reference(i,1);
        ref_y = pos_reference(i,2);
        ref_z = pos_reference(i,3);
        
        output(i,1) = sqrt((diff_x-ref_x)^2+(diff_y-ref_y)^2+(diff_z-ref_z)^2);
        
    end
    
%     disp(strcat(["output: ", output]))

   

end

% 'trust-region-reflective'
% options = optimoptions(@lsqnonlin,'Algorithm', 'levenberg-marquardt','Display', 'iter', 'MaxFunctionEvaluations', 1000000, 'MaxIterations', 100000);
% options = optimoptions(@lsqnonlin,'Algorithm', 'trust-region-reflective','Display', 'iter', 'MaxFunctionEvaluations', 1000000, 'MaxIterations', 100000);
% lsqnonlin(@pos_endEffector, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[],[],options, data)
